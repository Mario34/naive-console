var B=Object.defineProperty,D=Object.defineProperties;var j=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var P=(i,a,e)=>a in i?B(i,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[a]=e,p=(i,a)=>{for(var e in a||(a={}))E.call(a,e)&&P(i,e,a[e]);if(N)for(var e of N(a))V.call(a,e)&&P(i,e,a[e]);return i},C=(i,a)=>D(i,j(a));import{d as b,ag as k,o as f,c as S,w as m,u as l,ak as G,q as L,M as O,O as A,a as h,ah as U,x as R,k as H,l as I,am as T,a0 as J,an as w,ao as K,j as Q,y as W,z as X,ai as Y,ap as Z,aq as q,ar as ee}from"./vendor.33471326.js";import{_ as ae}from"./index.e743df85.js";const te=I(" \u91CD\u7F6E "),ie=I(" \u641C\u7D22 ");var ne=b({props:{schemes:null,value:null},emits:["reset","search","fieldUpdate"],setup(i,{emit:a}){const e=i,t=k(),r=k({}),s=k(p({},e.value)),c=()=>{e.schemes.forEach(u=>{T(s.value,u.key,null),a("reset",{})})},d=()=>{a("search",s.value)},g=(u,v)=>{T(s.value,u,v),a("fieldUpdate",u,v)};return(u,v)=>(f(),S(l(G),{ref_key:"formRef",ref:t,model:s.value,inline:"",size:"small","label-width":"{80}","label-placement":"left"},{default:m(()=>[(f(!0),L(A,null,O(i.schemes,n=>(f(),S(l(U),{key:n.key,label:n.title,path:n.key},{default:m(()=>[(f(),S(J(n.field),w({ref_for:!0,ref:o=>r.value[n.key]=o},n.props,{value:l(K)(s.value,n.key),"onUpdate:value":o=>g(n.key,o)}),null,16,["value","onUpdate:value"]))]),_:2},1032,["label","path"]))),128)),h(l(U),null,{default:m(()=>[h(l(H),null,{default:m(()=>[h(l(R),{size:"medium",onClick:c},{default:m(()=>[te]),_:1}),h(l(R),{size:"medium",type:"primary",onClick:d},{default:m(()=>[ie]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))}});var se=ae(ne,[["__scopeId","data-v-98c9a96a"]]);const le={class:""};var oe=b({props:{init:null,filterProps:null,tableProps:null},setup(i){const a=i;let e=k(null),t=null;const r=n=>{e.value=n},s=n=>{t=n},c=n=>{var o,y,_;t&&t.getList(p({page:n,pageSize:(y=(o=e==null?void 0:e.value)==null?void 0:o.pagination.pageSize)!=null?y:10},(_=e==null?void 0:e.value)==null?void 0:_.filter))},d=n=>{var o;e.value&&t&&(e.value.pagination.pageSize=n,t.getList(p({page:1,pageSize:n},(o=e==null?void 0:e.value)==null?void 0:o.filter)))},g=n=>{var o;e.value&&t&&t.getList(p({page:e.value.pagination.page,pageSize:e.value.pagination.pageSize},(o=e==null?void 0:e.value)==null?void 0:o.filter))},u=()=>{e.value&&(e.value.filter={})},v=(n,o)=>{e.value&&(e.value.filter[n]=o)};return a.init({bindState:r,bindMethods:s}),(n,o)=>{var y,_,x,M,F;return f(),L("div",le,[h(l(se),w(i.filterProps,{value:(y=l(e))==null?void 0:y.filter,style:{padding:"20px 0"},onSearch:g,onFieldUpdate:v,onReset:u}),null,16,["value"]),h(l(Q),w({remote:""},i.tableProps,{data:(x=(_=l(e))==null?void 0:_.list)!=null?x:[],pagination:(M=l(e))==null?void 0:M.pagination,loading:(F=l(e))==null?void 0:F.loading,"onUpdate:page":c,"onUpdate:pageSize":d}),null,16,["data","pagination","loading"])])}}});const re=i=>{const a=W({loading:!1,initialized:!1,list:[],filter:p({},l(i.filter)),pagination:p({page:1,pageSize:10,pageCount:0,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100]},l(i.pagination))}),e=async s=>{try{a.loading=!0;const c=await i.getList(s);a.list=c.data,a.pagination.page=c.page,a.pagination.pageCount=c.pageCount,a.pagination.itemCount=c.itemCount}catch{a.list=[]}finally{a.loading=!1}},t=()=>e(p({page:a.pagination.page,pageSize:a.pagination.pageSize},a.filter)),r=s=>{a.filter=s};return{async init(s){s.bindState(a),s.bindMethods({getList:e,refresh:t,setFilter:r}),i.autoGetFirst&&await e(p({page:a.pagination.page,pageSize:a.pagination.pageSize},a.filter)),a.initialized=!0},refresh:t,setFilter:r,state:X(a)}},z=i=>new Promise(a=>{const e=setTimeout(a,i);return()=>{clearTimeout(e)}});let ce=1e3;const $=()=>++ce,pe=i=>{const a=[];let e=0;for(;e<i.total;){const t=$();a.push(C(p({},i.gRow(e,t)),{id:t})),e++}return{getList:async t=>(console.log("getList params",t),await z(500),{data:a.slice((t.page-1)*t.pageSize,t.page*t.pageSize),page:t.page,pageCount:Math.ceil(i.total/t.pageSize),itemCount:i.total,message:"success",query:t}),update:async t=>{await z(500);const r=a.findIndex(s=>s.id===t.id);return a.splice(r,1,p({},t)),{message:"success"}},add:async t=>(await z(500),a.push(C(p({},t),{id:$()})),{message:"success"}),remove:async t=>{await z(500);const r=a.findIndex(s=>s.id===t.id);return a.splice(r,1),{message:"success"}}}};var fe=b({setup(i){const a=pe({total:188,gRow(c,d){const g=["\u676D\u5DDE\u5E02","\u5B81\u6CE2\u5E02","\u6E29\u5DDE\u5E02","\u5609\u5174\u5E02","\u53F0\u5DDE","\u7ECD\u5174","\u91D1\u534E\u5E02","\u6E56\u5DDE\u5E02","\u8862\u5DDE\u5E02","\u4E3D\u6C34\u5E02","\u821F\u5C71\u5E02"];return{order:c+1,name:`\u7528\u6237${d}`,code:`EF${Math.random().toString().slice(-12)}`,type:Math.ceil(Math.random()*4),status:Math.ceil(Math.random()*4),city:g[Math.floor(Math.random()*g.length)],timestamp:Date.now()}}}),{init:e,state:t}=re({getList:a.getList,autoGetFirst:!0,pagination:{showSizePicker:!0},filter:{name:"hahahahha",type:"1"}}),r=[{title:"\u540D\u79F0",key:"name",field:Y},{title:"\u7C7B\u578B",key:"type",field:Z,props:{placeholder:"\u9009\u62E9\u7C7B\u578B",options:[{label:"\u7C7B\u578B1",value:"1"},{label:"\u7C7B\u578B2",value:"2"}]}},{title:"\u5E74\u9F84",key:"age",field:q},{title:"\u5F00\u5173",key:"off",field:ee}],s=[{title:"\u5E8F\u53F7",key:"order",align:"center"},{title:"\u7528\u6237\u540D",key:"name"},{title:"\u7F16\u7801",key:"code"},{title:"type",key:"type"},{title:"city",key:"city"},{title:"status",key:"status"},{title:"timestamp",key:"timestamp"}];return(c,d)=>(f(),S(l(oe),{init:l(e),"table-props":{columns:s},"filter-props":{schemes:r}},null,8,["init","table-props","filter-props"]))}});export{fe as default};
