var j=Object.defineProperty,B=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var N=(i,a,e)=>a in i?j(i,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[a]=e,p=(i,a)=>{for(var e in a||(a={}))E.call(a,e)&&N(i,e,a[e]);if(M)for(var e of M(a))V.call(a,e)&&N(i,e,a[e]);return i},b=(i,a)=>B(i,D(a));import{d as C,ab as k,o as f,c as S,w as m,u as s,af as G,q as L,O,P as Z,a as h,ac as U,x as R,k as A,l as I,ah as T,Z as H,ai as w,aj as J,j as K,y as Q,z as W,ad as X,ak as Y,al as q,am as ee}from"./vendor.4575fa9c.js";import{_ as ae}from"./index.0e8a15b7.js";const te=I(" \u91CD\u7F6E "),ie=I(" \u641C\u7D22 ");var ne=C({props:{schemes:null,value:null},emits:["reset","search","fieldUpdate"],setup(i,{emit:a}){const e=i,t=k(),r=k({}),l=k(p({},e.value)),c=()=>{e.schemes.forEach(u=>{T(l.value,u.key,null),a("reset",{})})},d=()=>{a("search",l.value)},g=(u,v)=>{T(l.value,u,v),a("fieldUpdate",u,v)};return(u,v)=>(f(),S(s(G),{ref_key:"formRef",ref:t,model:l.value,inline:"",size:"small","label-width":"{80}","label-placement":"left"},{default:m(()=>[(f(!0),L(Z,null,O(i.schemes,n=>(f(),S(s(U),{key:n.key,label:n.title,path:n.key},{default:m(()=>[(f(),S(H(n.field),w({ref_for:!0,ref:o=>r.value[n.key]=o},n.props,{value:s(J)(l.value,n.key),"onUpdate:value":o=>g(n.key,o)}),null,16,["value","onUpdate:value"]))]),_:2},1032,["label","path"]))),128)),h(s(U),null,{default:m(()=>[h(s(A),null,{default:m(()=>[h(s(R),{size:"medium",onClick:c},{default:m(()=>[te]),_:1}),h(s(R),{size:"medium",type:"primary",onClick:d},{default:m(()=>[ie]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))}});var le=ae(ne,[["__scopeId","data-v-31d899d2"]]);const se={class:""};var oe=C({props:{init:null,filterProps:null,tableProps:null},setup(i){const a=i;let e=k(null),t=null;const r=n=>{e.value=n},l=n=>{t=n},c=n=>{var o,y,_;t&&t.getList(p({page:n,pageSize:(y=(o=e==null?void 0:e.value)==null?void 0:o.pagination.pageSize)!=null?y:10},(_=e==null?void 0:e.value)==null?void 0:_.filter))},d=n=>{var o;e.value&&t&&(e.value.pagination.pageSize=n,t.getList(p({page:1,pageSize:n},(o=e==null?void 0:e.value)==null?void 0:o.filter)))},g=n=>{var o;e.value&&t&&t.getList(p({page:e.value.pagination.page,pageSize:e.value.pagination.pageSize},(o=e==null?void 0:e.value)==null?void 0:o.filter))},u=()=>{e.value&&(e.value.filter={})},v=(n,o)=>{e.value&&(e.value.filter[n]=o)};return a.init({bindState:r,bindMethods:l}),(n,o)=>{var y,_,x,P,F;return f(),L("div",se,[h(s(le),w(i.filterProps,{value:(y=s(e))==null?void 0:y.filter,style:{padding:"20px 0"},onSearch:g,onFieldUpdate:v,onReset:u}),null,16,["value"]),h(s(K),w({remote:""},i.tableProps,{data:(x=(_=s(e))==null?void 0:_.list)!=null?x:[],pagination:(P=s(e))==null?void 0:P.pagination,loading:(F=s(e))==null?void 0:F.loading,"onUpdate:page":c,"onUpdate:pageSize":d}),null,16,["data","pagination","loading"])])}}});const re=i=>{const a=Q({loading:!1,initialized:!1,list:[],filter:p({},s(i.filter)),pagination:p({page:1,pageSize:10,pageCount:0,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100]},s(i.pagination))}),e=async l=>{try{a.loading=!0;const c=await i.getList(l);a.list=c.data,a.pagination.page=c.page,a.pagination.pageCount=c.pageCount,a.pagination.itemCount=c.itemCount}catch{a.list=[]}finally{a.loading=!1}},t=()=>e(p({page:a.pagination.page,pageSize:a.pagination.pageSize},a.filter)),r=l=>{a.filter=l};return{async init(l){l.bindState(a),l.bindMethods({getList:e,refresh:t,setFilter:r}),i.autoGetFirst&&await e(p({page:a.pagination.page,pageSize:a.pagination.pageSize},a.filter)),a.initialized=!0},refresh:t,setFilter:r,state:W(a)}},z=i=>new Promise(a=>{const e=setTimeout(a,i);return()=>{clearTimeout(e)}});let ce=1e3;const $=()=>++ce,pe=i=>{const a=[];let e=0;for(;e<i.total;){const t=$();a.push(b(p({},i.gRow(e,t)),{id:t})),e++}return{getList:async t=>(console.log("getList params",t),await z(500),{data:a.slice((t.page-1)*t.pageSize,t.page*t.pageSize),page:t.page,pageCount:Math.ceil(i.total/t.pageSize),itemCount:i.total,message:"success",query:t}),update:async t=>{await z(500);const r=a.findIndex(l=>l.id===t.id);return a.splice(r,1,p({},t)),{message:"success"}},add:async t=>(await z(500),a.push(b(p({},t),{id:$()})),{message:"success"}),remove:async t=>{await z(500);const r=a.findIndex(l=>l.id===t.id);return a.splice(r,1),{message:"success"}}}};var fe=C({setup(i){const a=pe({total:188,gRow(c,d){const g=["\u676D\u5DDE\u5E02","\u5B81\u6CE2\u5E02","\u6E29\u5DDE\u5E02","\u5609\u5174\u5E02","\u53F0\u5DDE","\u7ECD\u5174","\u91D1\u534E\u5E02","\u6E56\u5DDE\u5E02","\u8862\u5DDE\u5E02","\u4E3D\u6C34\u5E02","\u821F\u5C71\u5E02"];return{order:c+1,name:`\u7528\u6237${d}`,code:`EF${Math.random().toString().slice(-12)}`,type:Math.ceil(Math.random()*4),status:Math.ceil(Math.random()*4),city:g[Math.floor(Math.random()*g.length)],timestamp:Date.now()}}}),{init:e,state:t}=re({getList:a.getList,autoGetFirst:!0,pagination:{showSizePicker:!0},filter:{name:"hahahahha",type:"1"}}),r=[{title:"\u540D\u79F0",key:"name",field:X},{title:"\u7C7B\u578B",key:"type",field:Y,props:{placeholder:"\u9009\u62E9\u7C7B\u578B",options:[{label:"\u7C7B\u578B1",value:"1"},{label:"\u7C7B\u578B2",value:"2"}]}},{title:"\u5E74\u9F84",key:"age",field:q},{title:"\u5F00\u5173",key:"off",field:ee}],l=[{title:"\u5E8F\u53F7",key:"order",align:"center"},{title:"\u7528\u6237\u540D",key:"name"},{title:"\u7F16\u7801",key:"code"},{title:"type",key:"type"},{title:"city",key:"city"},{title:"status",key:"status"},{title:"timestamp",key:"timestamp"}];return(c,d)=>(f(),S(s(oe),{init:s(e),"table-props":{columns:l},"filter-props":{schemes:r}},null,8,["init","table-props","filter-props"]))}});export{fe as default};
