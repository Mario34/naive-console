var j=Object.defineProperty,B=Object.defineProperties;var D=Object.getOwnPropertyDescriptors;var M=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var N=(i,a,e)=>a in i?j(i,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[a]=e,p=(i,a)=>{for(var e in a||(a={}))E.call(a,e)&&N(i,e,a[e]);if(M)for(var e of M(a))V.call(a,e)&&N(i,e,a[e]);return i},b=(i,a)=>B(i,D(a));import{d as C,ab as S,u as l,o as m,c as k,w as h,af as G,q as L,O,P as Z,a as v,ac as R,x as U,k as A,l as I,ah as T,Z as H,ai as w,aj as J,j as K,y as Q,z as W,ad as X,ak as Y,al as q,am as ee}from"./vendor.4575fa9c.js";import{_ as ae}from"./index.68a6eea6.js";const te=I(" \u91CD\u7F6E "),ie=I(" \u641C\u7D22 ");var ne=C({props:{schemes:null,value:null},emits:["reset","search","fieldUpdate"],setup(i,{emit:a}){var y;const e=i,t=S(),r=S({}),n=S((y=l(e.value))!=null?y:{}),c=()=>{e.schemes.forEach(u=>{T(n.value,u.key,null),a("reset",{})})},g=()=>{a("search",n.value)},f=(u,o)=>{T(n.value,o,u),a("fieldUpdate",o,u)};return(u,o)=>(m(),k(l(G),{ref_key:"formRef",ref:t,model:n.value,inline:"",size:"small","label-width":"{80}","label-placement":"left"},{default:h(()=>[(m(!0),L(Z,null,O(i.schemes,s=>(m(),k(l(R),{key:s.key,label:s.title,path:s.key},{default:h(()=>[(m(),k(H(s.field),w({ref_for:!0,ref:d=>r.value[s.key]=d},s.props,{value:l(J)(n.value,s.key),"onUpdate:value":f}),null,16,["value"]))]),_:2},1032,["label","path"]))),128)),v(l(R),null,{default:h(()=>[v(l(A),null,{default:h(()=>[v(l(U),{size:"medium",onClick:c},{default:h(()=>[te]),_:1}),v(l(U),{size:"medium",type:"primary",onClick:g},{default:h(()=>[ie]),_:1})]),_:1})]),_:1})]),_:1},8,["model"]))}});var se=ae(ne,[["__scopeId","data-v-0f56fb3c"]]);const le={class:""};var oe=C({props:{init:null,filterProps:null,tableProps:null},setup(i){const a=i;let e=S(null),t=null;const r=o=>{e.value=o},n=o=>{t=o},c=o=>{var s,d,_;t&&t.getList(p({page:o,pageSize:(d=(s=e==null?void 0:e.value)==null?void 0:s.pagination.pageSize)!=null?d:10},(_=e==null?void 0:e.value)==null?void 0:_.filter))},g=o=>{var s;e.value&&t&&(e.value.pagination.pageSize=o,t.getList(p({page:1,pageSize:o},(s=e==null?void 0:e.value)==null?void 0:s.filter)))},f=o=>{var s;e.value&&t&&t.getList(p({page:e.value.pagination.page,pageSize:e.value.pagination.pageSize},(s=e==null?void 0:e.value)==null?void 0:s.filter))},y=()=>{e.value&&(e.value.filter={})},u=(o,s)=>{e.value&&(e.value.filter[o]=s)};return a.init({bindState:r,bindMethods:n}),(o,s)=>{var d,_,x,P,F;return m(),L("div",le,[v(l(se),w(i.filterProps,{value:(d=l(e))==null?void 0:d.filter,style:{padding:"20px 0"},onSearch:f,onFieldUpdate:u,onReset:y}),null,16,["value"]),v(l(K),w({remote:""},i.tableProps,{data:(x=(_=l(e))==null?void 0:_.list)!=null?x:[],pagination:(P=l(e))==null?void 0:P.pagination,loading:(F=l(e))==null?void 0:F.loading,"onUpdate:page":c,"onUpdate:pageSize":g}),null,16,["data","pagination","loading"])])}}});const re=i=>{const a=Q({loading:!1,initialized:!1,list:[],filter:p({},l(i.filter)),pagination:p({page:1,pageSize:10,pageCount:0,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100]},l(i.pagination))}),e=async n=>{try{a.loading=!0;const c=await i.getList(n);a.list=c.data,a.pagination.page=c.page,a.pagination.pageCount=c.pageCount,a.pagination.itemCount=c.itemCount}catch{a.list=[]}finally{a.loading=!1}},t=()=>e(p({page:a.pagination.page,pageSize:a.pagination.pageSize},a.filter)),r=n=>{a.filter=n};return{async init(n){n.bindState(a),n.bindMethods({getList:e,refresh:t,setFilter:r}),i.autoGetFirst&&await e(p({page:a.pagination.page,pageSize:a.pagination.pageSize},a.filter)),a.initialized=!0},refresh:t,setFilter:r,state:W(a)}},z=i=>new Promise(a=>{const e=setTimeout(a,i);return()=>{clearTimeout(e)}});let ce=1e3;const $=()=>++ce,pe=i=>{const a=[];let e=0;for(;e<i.total;){const t=$();a.push(b(p({},i.gRow(e,t)),{id:t})),e++}return{getList:async t=>(console.log("getList params",t),await z(500),{data:a.slice((t.page-1)*t.pageSize,t.page*t.pageSize),page:t.page,pageCount:Math.ceil(i.total/t.pageSize),itemCount:i.total,message:"success",query:t}),update:async t=>{await z(500);const r=a.findIndex(n=>n.id===t.id);return a.splice(r,1,p({},t)),{message:"success"}},add:async t=>(await z(500),a.push(b(p({},t),{id:$()})),{message:"success"}),remove:async t=>{await z(500);const r=a.findIndex(n=>n.id===t.id);return a.splice(r,1),{message:"success"}}}};var fe=C({setup(i){const a=pe({total:188,gRow(c,g){const f=["\u676D\u5DDE\u5E02","\u5B81\u6CE2\u5E02","\u6E29\u5DDE\u5E02","\u5609\u5174\u5E02","\u53F0\u5DDE","\u7ECD\u5174","\u91D1\u534E\u5E02","\u6E56\u5DDE\u5E02","\u8862\u5DDE\u5E02","\u4E3D\u6C34\u5E02","\u821F\u5C71\u5E02"];return{order:c+1,name:`\u7528\u6237${g}`,code:`EF${Math.random().toString().slice(-12)}`,type:Math.ceil(Math.random()*4),status:Math.ceil(Math.random()*4),city:f[Math.floor(Math.random()*f.length)],timestamp:Date.now()}}}),{init:e,state:t}=re({getList:a.getList,autoGetFirst:!0,pagination:{showSizePicker:!0},filter:{name:"hahahahha",type:"1"}}),r=[{title:"\u540D\u79F0",key:"name",field:X},{title:"\u7C7B\u578B",key:"type",field:Y,props:{placeholder:"\u9009\u62E9\u7C7B\u578B",options:[{label:"\u7C7B\u578B1",value:"1"},{label:"\u7C7B\u578B2",value:"2"}]}},{title:"\u5E74\u9F84",key:"age",field:q},{title:"\u5F00\u5173",key:"off",field:ee}],n=[{title:"\u5E8F\u53F7",key:"order",align:"center"},{title:"\u7528\u6237\u540D",key:"name"},{title:"\u7F16\u7801",key:"code"},{title:"type",key:"type"},{title:"city",key:"city"},{title:"status",key:"status"},{title:"timestamp",key:"timestamp"}];return(c,g)=>(m(),k(l(oe),{init:l(e),"table-props":{columns:n},"filter-props":{schemes:r}},null,8,["init","table-props","filter-props"]))}});export{fe as default};
