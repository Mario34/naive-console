var T=Object.defineProperty,j=Object.defineProperties;var V=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable;var R=(a,t,e)=>t in a?T(a,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[t]=e,c=(a,t)=>{for(var e in t||(t={}))B.call(t,e)&&R(a,e,t[e]);if(N)for(var e of N(t))D.call(t,e)&&R(a,e,t[e]);return a},b=(a,t)=>j(a,V(t));import{d as w,ah as E,ae as G,x as O,k as A,af as L,aa as S,u,aj as Q,ak as U,O as k,o as m,c as z,w as h,q as x,P as H,Q as J,a as _,l as $,_ as K,al as F,j as W,y as X,z as Y,am as Z,an as q,ao as ee}from"./vendor.d49bf446.js";import{_ as te}from"./index.89396d0d.js";var ae=w({name:"CForm",components:{NForm:E,NFormItem:G,NButton:O,NSpace:A,NInput:L},props:{schemes:{type:Array,required:!0},value:{type:Object,default:void 0}},expose:[],emits:["reset","search","fieldUpdate"],setup(a,{emit:t}){var d;const e=S(),n=S({}),i=S((d=u(a.value))!=null?d:{});return{get:Q,formRef:e,formValue:i,fieldRefs:n,onReset:()=>{a.schemes.forEach(r=>{U(i.value,r.key,null),t("reset",{})})},onSearch:()=>{t("search",i.value)},onFieldUpdate:(r,f)=>{U(i.value,f,r),t("fieldUpdate",f,r)}}}});const ne=$(" \u91CD\u7F6E "),ie=$(" \u641C\u7D22 ");function se(a,t,e,n,i,s){const l=k("n-form-item"),d=k("n-button"),r=k("n-space"),f=k("n-form");return m(),z(f,{ref:"formRef",model:a.formValue,inline:"",size:"small","label-width":"{80}","label-placement":"left"},{default:h(()=>[(m(!0),x(J,null,H(a.schemes,g=>(m(),z(l,{key:g.key,label:g.title,path:g.key},{default:h(()=>[(m(),z(K(g.field),F({ref_for:!0,ref:o=>a.fieldRefs[g.key]=o},g.props,{value:a.get(a.formValue,g.key),"onUpdate:value":o=>a.onFieldUpdate(o,g.key)}),null,16,["value","onUpdate:value"]))]),_:2},1032,["label","path"]))),128)),_(l,null,{default:h(()=>[_(r,null,{default:h(()=>[_(d,{size:"medium",onClick:a.onReset},{default:h(()=>[ne]),_:1},8,["onClick"]),_(d,{size:"medium",type:"primary",onClick:a.onSearch},{default:h(()=>[ie]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["model"])}var oe=te(ae,[["render",se],["__scopeId","data-v-9360894c"]]);const le={class:""};var re=w({props:{init:null,filterProps:null,tableProps:null},setup(a){const t=a;let e=S(null),n=null;const i=o=>{e.value=o},s=o=>{n=o},l=o=>{var p,v,y;n&&n.getList(c({page:o,pageSize:(v=(p=e==null?void 0:e.value)==null?void 0:p.pagination.pageSize)!=null?v:10},(y=e==null?void 0:e.value)==null?void 0:y.filter))},d=o=>{var p;e.value&&n&&(e.value.pagination.pageSize=o,n.getList(c({page:1,pageSize:o},(p=e==null?void 0:e.value)==null?void 0:p.filter)))},r=o=>{var p;e.value&&n&&n.getList(c({page:e.value.pagination.page,pageSize:e.value.pagination.pageSize},(p=e==null?void 0:e.value)==null?void 0:p.filter))},f=()=>{e.value&&(e.value.filter={})},g=(o,p)=>{e.value&&(e.value.filter[o]=p)};return t.init({bindState:i,bindMethods:s}),(o,p)=>{var v,y,P,M;return m(),x("div",le,[_(u(oe),F(a.filterProps,{value:u(e).filter,style:{padding:"20px 0"},onSearch:r,onFieldUpdate:g,onReset:f}),null,16,["value"]),_(u(W),F({remote:""},a.tableProps,{data:(y=(v=u(e))==null?void 0:v.list)!=null?y:[],pagination:(P=u(e))==null?void 0:P.pagination,loading:(M=u(e))==null?void 0:M.loading,"onUpdate:page":l,"onUpdate:pageSize":d}),null,16,["data","pagination","loading"])])}}});const pe=a=>{const t=X({loading:!1,initialized:!1,list:[],filter:c({},u(a.filter)),pagination:c({page:1,pageSize:10,pageCount:0,itemCount:0,showSizePicker:!0,pageSizes:[10,20,50,100]},u(a.pagination))}),e=async s=>{try{t.loading=!0;const l=await a.getList(s);t.list=l.data,t.pagination.page=l.page,t.pagination.pageCount=l.pageCount,t.pagination.itemCount=l.itemCount}catch{t.list=[]}finally{t.loading=!1}},n=()=>e(c({page:t.pagination.page,pageSize:t.pagination.pageSize},t.filter)),i=s=>{t.filter=s};return{async init(s){s.bindState(t),s.bindMethods({getList:e,refresh:n,setFilter:i}),a.autoGetFirst&&await e(c({page:t.pagination.page,pageSize:t.pagination.pageSize},t.filter)),t.initialized=!0},refresh:n,setFilter:i,state:Y(t)}},C=a=>new Promise(t=>{const e=setTimeout(t,a);return()=>{clearTimeout(e)}});let ce=1e3;const I=()=>++ce,ue=a=>{const t=[];let e=0;for(;e<a.total;){const n=I();t.push(b(c({},a.gRow(e,n)),{id:n})),e++}return{getList:async n=>(console.log("getList params",n),await C(500),{data:t.slice((n.page-1)*n.pageSize,n.page*n.pageSize),page:n.page,pageCount:Math.ceil(a.total/n.pageSize),itemCount:a.total,message:"success",query:n}),update:async n=>{await C(500);const i=t.findIndex(s=>s.id===n.id);return t.splice(i,1,c({},n)),{message:"success"}},add:async n=>(await C(500),t.push(b(c({},n),{id:I()})),{message:"success"}),remove:async n=>{await C(500);const i=t.findIndex(s=>s.id===n.id);return t.splice(i,1),{message:"success"}}}};var me=w({setup(a){const t=ue({total:188,gRow(l,d){const r=["\u676D\u5DDE\u5E02","\u5B81\u6CE2\u5E02","\u6E29\u5DDE\u5E02","\u5609\u5174\u5E02","\u53F0\u5DDE","\u7ECD\u5174","\u91D1\u534E\u5E02","\u6E56\u5DDE\u5E02","\u8862\u5DDE\u5E02","\u4E3D\u6C34\u5E02","\u821F\u5C71\u5E02"];return{order:l+1,name:`\u7528\u6237${d}`,code:`EF${Math.random().toString().slice(-12)}`,type:Math.ceil(Math.random()*4),status:Math.ceil(Math.random()*4),city:r[Math.floor(Math.random()*r.length)],timestamp:Date.now()}}}),{init:e,state:n}=pe({getList:t.getList,autoGetFirst:!0,pagination:{showSizePicker:!0},filter:{name:"hahahahha",type:"1"}}),i=[{title:"\u540D\u79F0",key:"name",field:L},{title:"\u7C7B\u578B",key:"type",field:Z,props:{placeholder:"\u9009\u62E9\u7C7B\u578B",options:[{label:"\u7C7B\u578B1",value:"1"},{label:"\u7C7B\u578B2",value:"2"}]}},{title:"\u5E74\u9F84",key:"age",field:q},{title:"\u5F00\u5173",key:"off",field:ee}],s=[{title:"\u5E8F\u53F7",key:"order",align:"center"},{title:"\u7528\u6237\u540D",key:"name"},{title:"\u7F16\u7801",key:"code"},{title:"type",key:"type"},{title:"city",key:"city"},{title:"status",key:"status"},{title:"timestamp",key:"timestamp"}];return(l,d)=>(m(),z(u(re),{init:u(e),"table-props":{columns:s},"filter-props":{schemes:i}},null,8,["init","table-props","filter-props"]))}});export{me as default};
